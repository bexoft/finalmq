{
    "namespace":"hl7",
    "enums":[
    ],
    "structs":[

<% for (var key in hl7dictionary.fields) { 
    var field = hl7dictionary.fields[key] %>
        {"type":"<%- key %>","desc":"<%- field.desc -%>","fields":[ <% -%>
<% for (var i = 0; i < field.subfields.length; ++i) { 
    var subfield = field.subfields[i] %>
<% if (helper.isStruct(hl7dictionary.fields, subfield.datatype)) { -%>
            {"tid":"struct", "type":"<%- subfield.datatype %>", "name":"<%- subfield.name -%>"}<% -%>
<% } else { -%>
            {"tid":"string", "type":"", "name":"<%- subfield.name -%>"}<% -%>
<% } -%>
<% if (i != field.subfields.length - 1) { %>,<% } -%><% } %>
        ]},
<% } %>

<% for (var key in hl7dictionary.segments) { 
    var segment = hl7dictionary.segments[key] %>
        {"type":"<%- key %>","desc":"<%- segment.desc -%>","flags":["METASTRUCTFLAG_HL7_SEGMENT"],"fields":[ <% -%>
<% for (var i = 0; i < segment.fields.length; ++i) { 
    var field = segment.fields[i] %>
<% if (helper.isStruct(hl7dictionary.fields, field.datatype)) { -%>
            {"tid":"struct<% if (field.rep != 1) { %>[]<% } %>", "type":"<%- field.datatype %>", "name":"<%- field.name -%>"}<% -%>
<% } else { -%>
            {"tid":"string<% if (field.rep != 1) { %>[]<% } %>", "type":"", "name":"<%- field.name -%>"}<% -%>
<% } -%>
<% if (i != segment.fields.length - 1) { %>,<% } -%>
<% } %>
        ]},
<% } %>

<% for (var key in hl7dictionary.messages) { 
    var message = hl7dictionary.messages[key] -%>
        {"type":"<%- key %>","desc":"<%- message.desc.replaceAll('"') -%>","fields":[ <% -%>
<% for (var i = 0; i < message.segments.segments.length; ++i) { 
    var segment = message.segments.segments[i] %>
<% if ((!segment.children || Object.keys(segment.children).length == 0) &&
       (!segment.compounds || Object.keys(segment.compounds).length == 0)) { -%>
            {"tid":"struct<% if (segment.max != 1) { %>[]<% } %>", "type":"<%- segment.name %>", "name":"<%- segment.name.toLowerCase() + i -%>"}<% -%>
<% } else { -%>
            {"tid":"string", "type":"", "name":"dummydum"}<% -%>
<% } -%>
<% if (i != message.segments.segments.length - 1) { %>,<% } -%>
<% } %>
        ]},    
<% } %>

    ]
}


