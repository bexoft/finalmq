<html>                                                                          


<head>                                                                          

<script type="text/javascript" src="fmq.js"></script>

                                                                                
<script type="text/javascript" >

//////////////////////////////////////////////////////////////////////


var g_fmqSession = new FmqSession();
var g_fmqQtService = null;




function iterateObjects(obj, level, idParent)
{
    var table = '<table border="1">';
    
    table += '<tr>';
    table += '<td>Class Chain</td>';
    table += '<td>Properties</td>';
    table += '<td>Methods</td>';
    table += '<td>Children</td>';
    table += '</tr>';

    // Class Chain
    table += '<tr>';

    table += '<td>'
	for (var i = 0; i < obj.classchain.length; i++)
    {
		var className = obj.classchain[i];
        table += className;
        table += '<br/>';
    }
    table += '</td>';

    // properties
    table += '<td><table border="1">';
	for (var i = 0; i < obj.properties.length; i++)
	{
		var prop = obj.properties[i];
        table += '<tr>';
        table += '<td>' + prop.type + '</td>';
        table += '<td>' + prop.name + '</td>';
        table += '<td>' + prop.value.substr(0, 100) + '</td>';
        table += '<td>' + prop.hasNotifySignal + '</td>';

        table += '</tr>';
    }
    table += '</table></td>';

    // Methods
    table += '<td><table border="1">';
	for (var i = 0; i < obj.methods.length; i++)
    {
        var method = obj.methods[i];
        table += '<tr>';
        table += '<td>' + method.name + '</td>';
        table += '<td>' + method.index + '</td>';
        table += '<td>' + method.access + '</td>';
        table += '<td>' + method.methodType + '</td>';
        table += '<td>' + method.signature + '</td>';
        table += '<td>' + method.returnType.typeName + '</td>';

        // Parameters
        table += '<td><table border="1">';
        for (var j = 0; j < method.parameters.length; j++)
        {
            var parameter = method.parameters[j];
            table += '<tr>';
            table += '<td>' + parameter.name + '</td>';
            table += '<td>' + parameter.typeName + '</td>';
            table += '<td>' + parameter.typeId + '</td>';
            table += '</tr>';
        }
        table += '</table></td>';

        table += '</tr>';
    }
    table += '</table></td>';
    
    // Children
    table += '<td><table border="1">';
	for (var i = 0; i < obj.children.length; i++)
    {
        var id = idParent + '.' + i;
        table += '<tr>';
        table += '<td id="'+ id +'">';
        table += '</td>';
        table += '</tr>';
    }
    table += '</table></td>';

    table += '</tr>';
    
    document.getElementById(idParent).innerHTML = table;

	for (var i = 0; i < obj.children.length; i++)
    {
        var id = idParent + '.' + i;
        iterateObjects(obj.children[i], level + 1, id);
    }
}


function poll()
{
	getObjectTree();
}

function getObjectTree()
{
    g_fmqQtService.requestReply('finalmq.qt.GetObjectTreeRequest', null, function(outparams) {
        if (outparams.fmqheader.status == 'STATUS_OK')
        {
			document.getElementById('root').innerHTML = '';
            iterateObjects(outparams.root, 0, 'root', null);
        }
    });
}



function fmqReady()
{
	poll();
	//setInterval(poll, 2000);
}


function pageLoad()
{
    g_fmqSession.createSession(function() {
		g_fmqQtService = g_fmqSession.createEntity('QtService');
        fmqReady();
    });
}

function pageUnload()
{
    g_fmqSession.removeSession();
}
												 
												 
</script>                                                                       
                                                                          

</head>

                                                               
<body onload="pageLoad()" onunload="pageUnload()">





<div style="position:absolute; top:0; left:0; width:100%; height:100%;">
	<div style="position:absolute; top:0; left:0; width:100%; height:100%;" id="root">
	</div>	
</div>


</body>


</html>
       
